<div class="search-interface">
  <div class="search-header">
    <h1>Product Search</h1>
    <div class="search-stats">
      {{ searchResults.length }} products found
      <span *ngIf="selectedItems.length > 0" class="selected-count">‚Ä¢ {{ selectedItems.length }} selected</span>
    </div>
  </div>

  <div class="search-container">
    <div class="search-main">
      <form (ngSubmit)="handleSearch()" class="search-form">
        <div class="search-input-container">
          <input
            type="text"
            [(ngModel)]="searchQuery"
            (input)="onSearchQueryChange()"
            placeholder="Search for products..."
            class="search-input"
            name="searchQuery"
          />
          <button type="submit" class="search-btn">üîç</button>
          
          <div *ngIf="showSuggestions && suggestions.length > 0" class="search-suggestions">
            <div
              *ngFor="let suggestion of suggestions; let index = index"
              class="suggestion-item"
              (click)="handleSuggestionClick(suggestion)"
            >
              {{ suggestion }}
            </div>
          </div>
        </div>
      </form>

      <div class="search-controls">
        <div class="view-controls">
          <button 
            [class.active]="viewMode === 'grid'"
            (click)="viewMode = 'grid'"
            title="Grid View"
          >
            ‚äû
          </button>
          <button 
            [class.active]="viewMode === 'list'"
            (click)="viewMode = 'list'"
            title="List View"
          >
            ‚ò∞
          </button>
        </div>

        <div class="sort-controls">
          <label>Sort by:</label>
          <select [(ngModel)]="filters.sortBy" (change)="onFiltersChange()">
            <option *ngFor="let option of sortOptions" [value]="option.id">
              {{ option.name }}
            </option>
          </select>
        </div>

        <button 
          (click)="showFilters = !showFilters"
          class="filters-toggle"
        >
          Filters {{ showFilters ? '‚ñ≤' : '‚ñº' }}
        </button>
      </div>

      <div *ngIf="showFilters" class="filters-panel">
        <div class="filter-group">
          <label>Category</label>
          <select [(ngModel)]="filters.category" (change)="onFiltersChange()">
            <option *ngFor="let category of categories" [value]="category.id">
              {{ category.name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Brand</label>
          <select [(ngModel)]="filters.brand" (change)="onFiltersChange()">
            <option *ngFor="let brand of brands" [value]="brand.id">
              {{ brand.name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Price Range</label>
          <select [(ngModel)]="filters.priceRange" (change)="onFiltersChange()">
            <option *ngFor="let range of priceRanges" [value]="range.id">
              {{ range.name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Rating</label>
          <select [(ngModel)]="filters.rating" (change)="onFiltersChange()">
            <option *ngFor="let rating of ratings" [value]="rating.id">
              {{ rating.name }}
            </option>
          </select>
        </div>

        <div class="filter-group">
          <label>Availability</label>
          <select [(ngModel)]="filters.availability" (change)="onFiltersChange()">
            <option value="all">All Items</option>
            <option value="in-stock">In Stock</option>
            <option value="limited">Limited Stock</option>
            <option value="out-of-stock">Out of Stock</option>
          </select>
        </div>

        <button (click)="clearFilters()" class="clear-filters-btn">
          Clear All Filters
        </button>
      </div>

      <div *ngIf="isLoading" class="loading-state">
        <div class="loading-spinner"></div>
        <span>Searching...</span>
      </div>

      <div *ngIf="!isLoading" class="search-results">
        <div *ngIf="paginatedResults.length > 0" class="results-header">
          <label class="select-all-label">
            <input
              type="checkbox"
              [checked]="isAllSelected()"
              (change)="handleSelectAll()"
            />
            Select All
          </label>
        </div>

        <div [class]="'results-grid ' + viewMode">
          <div 
            *ngFor="let product of paginatedResults" 
            [class]="'product-card ' + (isItemSelected(product.id) ? 'selected' : '')"
          >
            <div class="product-checkbox">
              <input
                type="checkbox"
                [checked]="isItemSelected(product.id)"
                (change)="handleItemSelect(product.id)"
              />
            </div>

            <div class="product-image">
              <img [src]="product.image" [alt]="product.name" />
              <div *ngIf="product.availability === 'limited'" class="availability-badge limited">Limited</div>
              <div *ngIf="product.availability === 'out-of-stock'" class="availability-badge out-of-stock">Out of Stock</div>
            </div>

            <div class="product-info">
              <h3 class="product-name">{{ product.name }}</h3>
              <div class="product-brand">{{ product.brand }}</div>
              <div class="product-rating">
                <span class="stars">{{ renderStars(product.rating) }}</span>
                <span class="rating-text">({{ product.reviews }})</span>
              </div>
              <div class="product-price">${{ product.price.toFixed(2) }}</div>
              <div class="product-description">{{ product.description }}</div>
            </div>

            <div class="product-actions">
              <button class="add-to-cart-btn">Add to Cart</button>
              <button class="wishlist-btn">‚ô°</button>
            </div>
          </div>
        </div>

        <div *ngIf="totalPages > 1" class="pagination">
          <button 
            (click)="currentPage = Math.max(1, currentPage - 1)"
            [disabled]="currentPage === 1"
          >
            Previous
          </button>
          
          <button
            *ngFor="let page of [].constructor(totalPages); let i = index"
            (click)="currentPage = i + 1"
            [class.active]="currentPage === i + 1"
          >
            {{ i + 1 }}
          </button>
          
          <button 
            (click)="currentPage = Math.min(totalPages, currentPage + 1)"
            [disabled]="currentPage === totalPages"
          >
            Next
          </button>
        </div>
      </div>

      <div *ngIf="searchResults.length === 0 && !isLoading" class="no-results">
        <div class="no-results-icon">üîç</div>
        <h3>No products found</h3>
        <p>Try adjusting your search terms or filters</p>
        <button (click)="clearFilters()" class="clear-filters-btn">
          Clear All Filters
        </button>
      </div>
    </div>
  </div>
</div>
