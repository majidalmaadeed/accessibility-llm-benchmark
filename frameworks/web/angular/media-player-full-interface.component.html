<div [class]="'media-player ' + (isFullscreen ? 'fullscreen' : '')">
  <div class="video-container">
    <video
      #videoRef
      class="video-element"
      poster="https://via.placeholder.com/800x450/333/fff?text=Sample+Video"
      (mousemove)="onMouseMove()"
      (mouseleave)="onMouseLeave()"
    >
      <source src="https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" type="video/mp4" />
      <track kind="captions" srcLang="en" label="English" default />
      <track kind="captions" srcLang="es" label="Spanish" />
      <track kind="captions" srcLang="fr" label="French" />
      <track kind="captions" srcLang="de" label="German" />
    </video>

    <div *ngIf="isLoading" class="loading-overlay">
      <div class="loading-spinner"></div>
      <span>Loading...</span>
    </div>

    <div *ngIf="showControls" class="video-controls">
      <!-- Progress Bar -->
      <div class="progress-container" (click)="handleSeek($event)">
        <div class="progress-bar">
          <div 
            class="progress-fill" 
            [style.width.%]="(currentTime / duration) * 100"
          ></div>
          <div 
            class="progress-handle" 
            [style.left.%]="(currentTime / duration) * 100"
          ></div>
        </div>
      </div>

      <!-- Control Buttons -->
      <div class="controls-row">
        <div class="left-controls">
          <button 
            class="control-btn play-btn"
            (click)="togglePlay()"
          >
            {{ getPlayIcon() }}
          </button>

          <div class="time-display">
            {{ formatTime(currentTime) }} / {{ formatTime(duration) }}
          </div>

          <button 
            class="control-btn volume-btn"
            (click)="toggleMute()"
          >
            {{ getVolumeIcon() }}
          </button>

          <div class="volume-slider">
            <input
              type="range"
              min="0"
              max="1"
              step="0.1"
              [value]="isMuted ? 0 : volume"
              (input)="handleVolumeChange($event)"
              class="volume-range"
            />
          </div>
        </div>

        <div class="right-controls">
          <div class="playback-rate-menu">
            <button 
              class="control-btn"
              (click)="showSettingsMenu = !showSettingsMenu"
            >
              {{ playbackRate }}x
            </button>
            <div *ngIf="showSettingsMenu" class="settings-dropdown">
              <div class="settings-section">
                <div class="settings-label">Playback Speed</div>
                <button
                  *ngFor="let rate of playbackRates"
                  [class]="'settings-option ' + (playbackRate === rate ? 'active' : '')"
                  (click)="changePlaybackRate(rate); showSettingsMenu = false"
                >
                  {{ rate }}x
                </button>
              </div>
            </div>
          </div>

          <div class="quality-menu">
            <button 
              class="control-btn"
              (click)="showQualityMenu = !showQualityMenu"
            >
              {{ selectedQuality }}
            </button>
            <div *ngIf="showQualityMenu" class="quality-dropdown">
              <button
                *ngFor="let quality of qualityOptions"
                [class]="'quality-option ' + (selectedQuality === quality ? 'active' : '')"
                (click)="handleQualityChange(quality)"
              >
                {{ quality }}
              </button>
            </div>
          </div>

          <button 
            class="control-btn captions-btn"
            (click)="showCaptions = !showCaptions"
          >
            ðŸ“º
          </button>

          <button 
            class="control-btn fullscreen-btn"
            (click)="toggleFullscreen()"
          >
            {{ getFullscreenIcon() }}
          </button>
        </div>
      </div>
    </div>

    <!-- Captions Menu -->
    <div *ngIf="showCaptions" class="captions-menu">
      <div class="captions-header">Captions</div>
      <button
        *ngFor="let caption of captionOptions"
        [class]="'caption-option ' + (selectedCaption === caption ? 'active' : '')"
        (click)="handleCaptionChange(caption)"
      >
        {{ caption }}
      </button>
    </div>
  </div>

  <!-- Video Info -->
  <div class="video-info">
    <h3>Big Buck Bunny</h3>
    <p>A short animated film by the Blender Institute</p>
    <div class="video-meta">
      <span>Duration: {{ formatTime(duration) }}</span>
      <span>Quality: {{ selectedQuality }}</span>
      <span>Captions: {{ selectedCaption }}</span>
    </div>
  </div>
</div>
