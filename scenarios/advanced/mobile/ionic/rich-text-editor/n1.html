<ion-header>
  <ion-toolbar>
    <ion-title>Rich Text Editor</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="onSaveClicked()">
        <ion-icon name="save"></ion-icon>
      </ion-button>
      <ion-button (click)="onExportClicked()">
        <ion-icon name="download"></ion-icon>
      </ion-button>
      <ion-button (click)="onStatsClicked()">
        <ion-icon name="stats-chart"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Toolbar -->
  <ion-toolbar class="editor-toolbar">
    <div class="toolbar-content">
      <!-- Undo/Redo Group -->
      <div class="toolbar-group">
        <ion-button fill="clear" size="small" (click)="onUndoClicked()" [disabled]="!isUndoAvailable">
          <ion-icon name="arrow-undo"></ion-icon>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onRedoClicked()" [disabled]="!isRedoAvailable">
          <ion-icon name="arrow-redo"></ion-icon>
        </ion-button>
      </div>

      <div class="toolbar-separator"></div>

      <!-- Formatting Group -->
      <div class="toolbar-group">
        <ion-button fill="clear" size="small" (click)="onBoldClicked()" [class.active]="isBold">
          <ion-icon name="text"></ion-icon>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onItalicClicked()" [class.active]="isItalic">
          <ion-icon name="text"></ion-icon>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onUnderlineClicked()" [class.active]="isUnderline">
          <ion-icon name="text"></ion-icon>
        </ion-button>
      </div>

      <div class="toolbar-separator"></div>

      <!-- Font Size Group -->
      <div class="toolbar-group">
        <ion-button fill="clear" size="small" (click)="onFontSizeClicked()">
          {{ fontSize }}pt
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onTextColorClicked()">
          <div class="color-button" [style.background-color]="textColor"></div>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onBackgroundColorClicked()">
          <div class="color-button" [style.background-color]="backgroundColor"></div>
        </ion-button>
      </div>

      <div class="toolbar-separator"></div>

      <!-- Alignment Group -->
      <div class="toolbar-group">
        <ion-button fill="clear" size="small" (click)="onLeftAlignClicked()" [class.active]="alignment === 'left'">
          <ion-icon name="text"></ion-icon>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onCenterAlignClicked()" [class.active]="alignment === 'center'">
          <ion-icon name="text"></ion-icon>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onRightAlignClicked()" [class.active]="alignment === 'right'">
          <ion-icon name="text"></ion-icon>
        </ion-button>
      </div>

      <div class="toolbar-separator"></div>

      <!-- Insert Group -->
      <div class="toolbar-group">
        <ion-button fill="clear" size="small" (click)="onInsertClicked()">
          <ion-icon name="add"></ion-icon>
        </ion-button>
        <ion-button fill="clear" size="small" (click)="onStatsClicked()">
          <ion-icon name="stats-chart"></ion-icon>
        </ion-button>
      </div>
    </div>
  </ion-toolbar>

  <!-- Word Count Panel -->
  <div class="word-count-panel" *ngIf="showWordCount">
    <ion-text color="medium">Words: {{ wordCount }} | Characters: {{ charCount }}</ion-text>
  </div>

  <!-- Editor -->
  <div class="editor-container">
    <ion-textarea
      [(ngModel)]="content"
      placeholder="Start typing your document..."
      [style.font-size.px]="fontSize"
      [style.color]="textColor"
      [style.background-color]="backgroundColor"
      [style.text-align]="alignment"
      [style.font-weight]="isBold ? 'bold' : 'normal'"
      [style.font-style]="isItalic ? 'italic' : 'normal'"
      [style.text-decoration]="isUnderline ? 'underline' : 'none'"
      (ionInput)="onContentChanged()"
      class="editor-textarea">
    </ion-textarea>
  </div>
</ion-content>

<!-- Font Size Modal -->
<ion-modal [isOpen]="showFontSizeModal" (didDismiss)="onFontSizeModalDismissed()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Font Size</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="onFontSizeModalDismissed()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    
    <ion-content>
      <ion-list>
        <ion-item *ngFor="let size of fontSizes" (click)="onFontSizeSelected(size)">
          <ion-label [style.font-size.px]="size">{{ size }}pt</ion-label>
          <ion-icon name="checkmark" *ngIf="fontSize === size" slot="end" color="primary"></ion-icon>
        </ion-item>
      </ion-list>
    </ion-content>
  </ng-template>
</ion-modal>

<!-- Color Picker Modal -->
<ion-modal [isOpen]="showColorPickerModal" (didDismiss)="onColorPickerModalDismissed()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>{{ colorPickerTitle }}</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="onColorPickerModalDismissed()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    
    <ion-content>
      <div class="color-grid">
        <div class="color-item" 
             *ngFor="let color of colors" 
             [style.background-color]="color"
             [class.selected]="isColorSelected(color)"
             (click)="onColorSelected(color)">
          <ion-icon name="checkmark" *ngIf="isColorSelected(color)" color="white"></ion-icon>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>

<!-- Insert Menu Modal -->
<ion-modal [isOpen]="showInsertModal" (didDismiss)="onInsertModalDismissed()">
  <ng-template>
    <ion-header>
      <ion-toolbar>
        <ion-title>Insert</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="onInsertModalDismissed()">
            <ion-icon name="close"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    
    <ion-content>
      <div class="insert-menu">
        <div class="insert-item" (click)="onInsertImage()">
          <ion-icon name="image" size="large" color="primary"></ion-icon>
          <ion-label>Image</ion-label>
        </div>
        <div class="insert-item" (click)="onInsertLink()">
          <ion-icon name="link" size="large" color="primary"></ion-icon>
          <ion-label>Link</ion-label>
        </div>
        <div class="insert-item" (click)="onInsertTable()">
          <ion-icon name="grid" size="large" color="primary"></ion-icon>
          <ion-label>Table</ion-label>
        </div>
        <div class="insert-item" (click)="onInsertList()">
          <ion-icon name="list" size="large" color="primary"></ion-icon>
          <ion-label>List</ion-label>
        </div>
      </div>
    </ion-content>
  </ng-template>
</ion-modal>
