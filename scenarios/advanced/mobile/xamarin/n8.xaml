<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="UIComponents.SocialMediaFeedPage"
             xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             Title="Social Feed"
             BackgroundColor="#F5F5F5">

    <ContentPage.Content>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!-- Header -->
            <Grid Grid.Row="0" BackgroundColor="White" Padding="16">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <Label Grid.Column="0" 
                       Text="Social Feed" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       VerticalOptions="Center" />

                <Button Grid.Column="1" 
                        Text="🔔" 
                        BackgroundColor="Transparent" 
                        TextColor="#333" 
                        FontSize="24" 
                        WidthRequest="40" 
                        HeightRequest="40" 
                        Clicked="OnNotificationsClicked" />

                <Button Grid.Column="2" 
                        Text="📈" 
                        BackgroundColor="Transparent" 
                        TextColor="#333" 
                        FontSize="24" 
                        WidthRequest="40" 
                        HeightRequest="40" 
                        Clicked="OnTrendingClicked" />
            </Grid>

            <!-- Filter Tabs -->
            <Grid Grid.Row="1" BackgroundColor="White" Padding="0,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0" 
                        Text="All" 
                        BackgroundColor="#F0F0F0" 
                        TextColor="#666" 
                        BorderRadius="0" 
                        Clicked="OnFilterChanged" 
                        CommandParameter="all" />

                <Button Grid.Column="1" 
                        Text="Following" 
                        BackgroundColor="#F0F0F0" 
                        TextColor="#666" 
                        BorderRadius="0" 
                        Clicked="OnFilterChanged" 
                        CommandParameter="following" />

                <Button Grid.Column="2" 
                        Text="Trending" 
                        BackgroundColor="#F0F0F0" 
                        TextColor="#666" 
                        BorderRadius="0" 
                        Clicked="OnFilterChanged" 
                        CommandParameter="trending" />
            </Grid>

            <!-- Create Post Button -->
            <Button Grid.Row="2" 
                    Text="+ Create Post" 
                    BackgroundColor="#007AFF" 
                    TextColor="White" 
                    FontSize="16" 
                    FontAttributes="Bold" 
                    Margin="16" 
                    Padding="0,12" 
                    Clicked="OnCreatePostClicked" />

            <!-- Posts List -->
            <CollectionView Grid.Row="2" 
                            x:Name="PostsCollectionView" 
                            ItemsSource="{Binding Posts}"
                            Margin="0,60,0,0">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Grid BackgroundColor="White" 
                              Margin="16,8" 
                              Padding="16">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!-- Post Header -->
                            <Grid Grid.Row="0" Margin="0,0,0,12">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>

                                <Label Grid.Column="0" 
                                       Text="{Binding User.Avatar}" 
                                       FontSize="32" 
                                       Margin="0,0,12,0" />

                                <StackLayout Grid.Column="1" VerticalOptions="Center">
                                    <StackLayout Orientation="Horizontal" Spacing="4">
                                        <Label Text="{Binding User.Name}" 
                                               FontSize="16" 
                                               FontAttributes="Bold" />
                                        <Label Text="✓" 
                                               FontSize="16" 
                                               TextColor="#1DA1F2" 
                                               IsVisible="{Binding User.Verified}" />
                                    </StackLayout>
                                    <Label Text="{Binding User.Username}" 
                                           FontSize="14" 
                                           TextColor="#666" />
                                    <Label Text="{Binding Timestamp}" 
                                           FontSize="12" 
                                           TextColor="#999" />
                                </StackLayout>

                                <Button Grid.Column="2" 
                                        Text="⋯" 
                                        BackgroundColor="Transparent" 
                                        TextColor="#666" 
                                        FontSize="20" 
                                        Clicked="OnPostMenuClicked" 
                                        CommandParameter="{Binding Id}" />
                            </Grid>

                            <!-- Post Content -->
                            <StackLayout Grid.Row="1" Margin="0,0,0,12">
                                <Label Text="{Binding Content}" 
                                       FontSize="16" 
                                       LineBreakMode="WordWrap" />
                                
                                <Label Text="{Binding Image}" 
                                       FontSize="48" 
                                       HorizontalOptions="Center" 
                                       IsVisible="{Binding HasImage}" 
                                       Margin="0,12,0,0" />
                                
                                <StackLayout Orientation="Horizontal" 
                                             Spacing="4" 
                                             IsVisible="{Binding HasLocation}" 
                                             Margin="0,8,0,0">
                                    <Label Text="📍" FontSize="14" TextColor="#666" />
                                    <Label Text="{Binding Location}" 
                                           FontSize="12" 
                                           TextColor="#666" />
                                </StackLayout>
                            </StackLayout>

                            <!-- Post Actions -->
                            <Grid Grid.Row="2" 
                                  BackgroundColor="#F0F0F0" 
                                  Padding="0,12" 
                                  Margin="0,12,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <Button Grid.Column="0" 
                                        Text="{Binding LikeText}" 
                                        BackgroundColor="Transparent" 
                                        TextColor="{Binding LikeColor}" 
                                        Clicked="OnLikeClicked" 
                                        CommandParameter="{Binding Id}" />

                                <Button Grid.Column="1" 
                                        Text="{Binding CommentText}" 
                                        BackgroundColor="Transparent" 
                                        TextColor="#666" 
                                        Clicked="OnCommentClicked" 
                                        CommandParameter="{Binding Id}" />

                                <Button Grid.Column="2" 
                                        Text="{Binding ShareText}" 
                                        BackgroundColor="Transparent" 
                                        TextColor="#666" 
                                        Clicked="OnShareClicked" 
                                        CommandParameter="{Binding Id}" />

                                <Button Grid.Column="3" 
                                        Text="{Binding BookmarkText}" 
                                        BackgroundColor="Transparent" 
                                        TextColor="{Binding BookmarkColor}" 
                                        Clicked="OnBookmarkClicked" 
                                        CommandParameter="{Binding Id}" />
                            </Grid>
                        </Grid>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Loading Indicator -->
            <ActivityIndicator x:Name="LoadingIndicator"
                              IsVisible="False" 
                              IsRunning="False" 
                              Color="#007AFF" 
                              VerticalOptions="Center" 
                              HorizontalOptions="Center" />
        </Grid>
    </ContentPage.Content>
</ContentPage>
