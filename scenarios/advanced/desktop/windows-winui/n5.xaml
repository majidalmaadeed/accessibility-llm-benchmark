<Page x:Class="UIComponents.RichTextEditor"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      mc:Ignorable="d"
      Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Command Bar -->
        <CommandBar Grid.Row="0" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}">
            <AppBarButton Icon="NewFolder" Label="New" Click="NewButton_Click"/>
            <AppBarButton Icon="OpenFile" Label="Open" Click="OpenButton_Click"/>
            <AppBarButton Icon="Save" Label="Save" Click="SaveButton_Click"/>
            <AppBarButton Icon="SaveAs" Label="Save As" Click="SaveAsButton_Click"/>
            
            <CommandBarSeparator/>
            
            <AppBarButton Icon="Undo" Label="Undo" Click="UndoButton_Click"/>
            <AppBarButton Icon="Redo" Label="Redo" Click="RedoButton_Click"/>
            
            <CommandBarSeparator/>
            
            <AppBarButton Icon="Cut" Label="Cut" Click="CutButton_Click"/>
            <AppBarButton Icon="Copy" Label="Copy" Click="CopyButton_Click"/>
            <AppBarButton Icon="Paste" Label="Paste" Click="PasteButton_Click"/>
        </CommandBar>
        
        <!-- Toolbar -->
        <Border Grid.Row="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
               BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="0,0,0,1">
            <ScrollViewer HorizontalScrollMode="Auto" VerticalScrollMode="Disabled">
                <StackPanel Orientation="Horizontal" Spacing="8" Padding="16,12">
                    <!-- Undo/Redo -->
                    <Button Name="UndoButton" Content="↶" Width="32" Height="32" 
                           Click="UndoButton_Click" ToolTipService.ToolTip="Undo"/>
                    <Button Name="RedoButton" Content="↷" Width="32" Height="32" 
                           Click="RedoButton_Click" ToolTipService.ToolTip="Redo"/>
                    
                    <Separator Orientation="Vertical" Margin="8,0"/>
                    
                    <!-- Formatting -->
                    <Button Name="BoldButton" Content="B" FontWeight="Bold" Width="32" Height="32" 
                           Click="BoldButton_Click" ToolTipService.ToolTip="Bold"/>
                    <Button Name="ItalicButton" Content="I" FontStyle="Italic" Width="32" Height="32" 
                           Click="ItalicButton_Click" ToolTipService.ToolTip="Italic"/>
                    <Button Name="UnderlineButton" Content="U" TextDecorations="Underline" Width="32" Height="32" 
                           Click="UnderlineButton_Click" ToolTipService.ToolTip="Underline"/>
                    
                    <Separator Orientation="Vertical" Margin="8,0"/>
                    
                    <!-- Font Size -->
                    <ComboBox Name="FontSizeComboBox" Width="60" 
                             SelectionChanged="FontSizeComboBox_SelectionChanged" 
                             ToolTipService.ToolTip="Font Size">
                        <ComboBoxItem Content="8"/>
                        <ComboBoxItem Content="9"/>
                        <ComboBoxItem Content="10"/>
                        <ComboBoxItem Content="11"/>
                        <ComboBoxItem Content="12"/>
                        <ComboBoxItem Content="14"/>
                        <ComboBoxItem Content="16" IsSelected="True"/>
                        <ComboBoxItem Content="18"/>
                        <ComboBoxItem Content="20"/>
                        <ComboBoxItem Content="24"/>
                        <ComboBoxItem Content="28"/>
                        <ComboBoxItem Content="32"/>
                        <ComboBoxItem Content="36"/>
                        <ComboBoxItem Content="48"/>
                        <ComboBoxItem Content="72"/>
                    </ComboBox>
                    
                    <!-- Font Family -->
                    <ComboBox Name="FontFamilyComboBox" Width="120" 
                             SelectionChanged="FontFamilyComboBox_SelectionChanged" 
                             ToolTipService.ToolTip="Font Family">
                        <ComboBoxItem Content="Arial" IsSelected="True"/>
                        <ComboBoxItem Content="Calibri"/>
                        <ComboBoxItem Content="Times New Roman"/>
                        <ComboBoxItem Content="Courier New"/>
                        <ComboBoxItem Content="Georgia"/>
                        <ComboBoxItem Content="Verdana"/>
                        <ComboBoxItem Content="Tahoma"/>
                    </ComboBox>
                    
                    <Separator Orientation="Vertical" Margin="8,0"/>
                    
                    <!-- Text Color -->
                    <Button Name="TextColorButton" Content="A" Width="32" Height="32" 
                           Click="TextColorButton_Click" ToolTipService.ToolTip="Text Color"/>
                    
                    <!-- Background Color -->
                    <Button Name="BackgroundColorButton" Content="🖍" Width="32" Height="32" 
                           Click="BackgroundColorButton_Click" ToolTipService.ToolTip="Background Color"/>
                    
                    <Separator Orientation="Vertical" Margin="8,0"/>
                    
                    <!-- Alignment -->
                    <Button Name="LeftAlignButton" Content="⬅" Width="32" Height="32" 
                           Click="LeftAlignButton_Click" ToolTipService.ToolTip="Align Left"/>
                    <Button Name="CenterAlignButton" Content="⬆" Width="32" Height="32" 
                           Click="CenterAlignButton_Click" ToolTipService.ToolTip="Align Center"/>
                    <Button Name="RightAlignButton" Content="➡" Width="32" Height="32" 
                           Click="RightAlignButton_Click" ToolTipService.ToolTip="Align Right"/>
                    <Button Name="JustifyButton" Content="⬌" Width="32" Height="32" 
                           Click="JustifyButton_Click" ToolTipService.ToolTip="Justify"/>
                    
                    <Separator Orientation="Vertical" Margin="8,0"/>
                    
                    <!-- Lists -->
                    <Button Name="BulletListButton" Content="•" Width="32" Height="32" 
                           Click="BulletListButton_Click" ToolTipService.ToolTip="Bullet List"/>
                    <Button Name="NumberedListButton" Content="1." Width="32" Height="32" 
                           Click="NumberedListButton_Click" ToolTipService.ToolTip="Numbered List"/>
                    
                    <Separator Orientation="Vertical" Margin="8,0"/>
                    
                    <!-- Insert -->
                    <Button Name="InsertImageButton" Content="🖼" Width="32" Height="32" 
                           Click="InsertImageButton_Click" ToolTipService.ToolTip="Insert Image"/>
                    <Button Name="InsertTableButton" Content="⊞" Width="32" Height="32" 
                           Click="InsertTableButton_Click" ToolTipService.ToolTip="Insert Table"/>
                    <Button Name="InsertLinkButton" Content="🔗" Width="32" Height="32" 
                           Click="InsertLinkButton_Click" ToolTipService.ToolTip="Insert Link"/>
                </StackPanel>
            </ScrollViewer>
        </Border>
        
        <!-- Main Content Area -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="300"/>
            </Grid.ColumnDefinitions>
            
            <!-- Rich Text Editor -->
            <RichEditBox Name="RichEditBox" Grid.Column="0" Margin="16" 
                        TextChanged="RichEditBox_TextChanged" 
                        SelectionChanged="RichEditBox_SelectionChanged"
                        AcceptsReturn="True" AcceptsTab="True"
                        VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"/>
            
            <!-- Side Panel -->
            <Border Grid.Column="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                   BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="1,0,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <!-- Document Statistics -->
                    <Border Grid.Row="0" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                           Margin="16" Padding="16" CornerRadius="8">
                        <StackPanel>
                            <TextBlock Text="Document Statistics" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                            <TextBlock Name="WordCountText" Text="Words: 0" FontSize="14"/>
                            <TextBlock Name="CharacterCountText" Text="Characters: 0" FontSize="14"/>
                            <TextBlock Name="ParagraphCountText" Text="Paragraphs: 0" FontSize="14"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Quick Styles -->
                    <Border Grid.Row="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                           Margin="16,8" Padding="16" CornerRadius="8">
                        <StackPanel>
                            <TextBlock Text="Quick Styles" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                            <Button Name="Heading1Button" Content="Heading 1" Margin="0,2" 
                                   Click="Heading1Button_Click"/>
                            <Button Name="Heading2Button" Content="Heading 2" Margin="0,2" 
                                   Click="Heading2Button_Click"/>
                            <Button Name="Heading3Button" Content="Heading 3" Margin="0,2" 
                                   Click="Heading3Button_Click"/>
                            <Button Name="NormalButton" Content="Normal" Margin="0,2" 
                                   Click="NormalButton_Click"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Recent Files -->
                    <Border Grid.Row="2" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                           Margin="16,8" Padding="16" CornerRadius="8">
                        <StackPanel>
                            <TextBlock Text="Recent Files" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                            <ListView Name="RecentFilesListView" Height="150" 
                                    SelectionChanged="RecentFilesListView_SelectionChanged">
                                <ListViewItem Content="Document1.docx"/>
                                <ListViewItem Content="Report.docx"/>
                                <ListViewItem Content="Notes.docx"/>
                            </ListView>
                        </StackPanel>
                    </Border>
                    
                    <!-- Zoom Control -->
                    <Border Grid.Row="3" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
                           Margin="16,8" Padding="16" CornerRadius="8">
                        <StackPanel>
                            <TextBlock Text="Zoom" FontWeight="Bold" FontSize="16" Margin="0,0,0,8"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBlock Grid.Column="0" Name="ZoomText" Text="100%" 
                                          VerticalAlignment="Center" HorizontalAlignment="Center" FontSize="14"/>
                                <Button Grid.Column="1" Name="ZoomOutButton" Content="-" Width="28" Height="28" 
                                       Click="ZoomOutButton_Click" Margin="4"/>
                                <Button Grid.Column="2" Name="ZoomInButton" Content="+" Width="28" Height="28" 
                                       Click="ZoomInButton_Click" Margin="4"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>
        </Grid>
        
        <!-- Status Bar -->
        <Border Grid.Row="3" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" 
               BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}" BorderThickness="0,1,0,0">
            <Grid Padding="16,8">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Name="StatusText" Text="Ready" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Column="1" Name="PositionText" Text="Line 1, Column 1" 
                          VerticalAlignment="Center" FontSize="12"/>
            </Grid>
        </Border>
    </Grid>
</Page>
